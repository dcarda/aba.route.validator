<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbaRouteValidator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ABA Route Transit Number Validator</a> &gt; <a href="index.source.html" class="el_package">com.cardatechnologies.utils.validators.abaroutevalidator</a> &gt; <span class="el_source">AbaRouteValidator.java</span></div><h1>AbaRouteValidator.java</h1><pre class="source lang-java linenums">/* ---------------------------------------------------------------------------------------
 * Class:  com.cardatechnologies.utils.validators.abaroutevalidator.AbaRouteValidator.java
 * Date:   2015/02/11
 * ---------------------------------------------------------------------------------------
 *
 *  License: Apache 2.0
 *
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use
 *  this file except in compliance with the License.
 *
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software distributed under
 *  the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS
 *  OF ANY KIND, either express or implied including the implied warranties of
 *  merchantability and fitness for a particular purpose.
 *
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
package com.cardatechnologies.utils.validators.abaroutevalidator;

//~--- non-JDK imports --------------------------------------------------------

import com.cardatechnologies.utils.validators.abaroutevalidator.exceptions.AbaRouteValidationException;

/**
 * &lt;b&gt;Description:&lt;/b&gt;&lt;br&gt;
 *     This class is used to validate a ABA Routing Transit Number.
 *
 * @author     Daniel Carda
 * &lt;br&gt;
 * &lt;br&gt;&lt;b&gt;Maintenance History:&lt;/b&gt;
 * &lt;br&gt;
&lt;pre&gt;
    yyyy mm dd  Who                       Description
    ----------  ------------------------  ----------------------------------------------------
    2015/02/11  Daniel Carda              Initial Module Creation...
    2020/12/23  Daniel Carda              Started using and ENum for error content.
    2020/12/24  Daniel Carda              Optimized algorithms.
    2021/08/01  Daniel Carda              Improved Class Javadocs
&lt;/pre&gt;
 * &lt;hr&gt;
 */
<span class="nc" id="L47">public class AbaRouteValidator {</span>

    /**
     * Method description
     *
     * @param  paramAbaRouteNumber
     *         The incoming ABA Number.
     *
     * @return boolean
     *         True if all the characters were digits.
     *         False if there was a problem.
     *
     * @throws AbaRouteValidationException
     *         There was a problem somewhere not related to checking the ABA number.
     */
    private static boolean breakdownAbaNumber( final String paramAbaRouteNumber )
            throws AbaRouteValidationException {

        // Check first two digits.
<span class="nc" id="L66">        validateFedNumber( paramAbaRouteNumber );</span>

        // Alright, now see if the number holds up to scrutiny!
        boolean returnBool;

<span class="nc" id="L71">        returnBool = validateAbaNumberChecksum( paramAbaRouteNumber );</span>

        // Return the result
<span class="nc" id="L74">        return( returnBool );</span>
    }

    /**
     * This method is the starting point to validate whether a incoming string is
     * a valid ABA Routing Transit Number.
     *
     * @param   paramAbaRouteNumber The ABA number to be tested.
     *
     * @return boolean
     *         True if all the characters were digits.
     *         False if there was a problem.
     *
     * @throws AbaRouteValidationException
     *         A error occurred when parsing the suspect
     *         ABA Routing Transit Number.
     */
    static public boolean validate( final String paramAbaRouteNumber )
            throws AbaRouteValidationException {

        // http://en.wikipedia.org/wiki/Routing_transit_number
        //
        // See FRB Regulation CC, Appendix A, which available online here:
        // &lt;http://www.bankersonline.com/regs/229/a229a.html&gt;
        // Quick Check
        // Is the parameter null
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if( paramAbaRouteNumber == null ) {</span>
<span class="nc" id="L101">            throw new AbaRouteValidationException( ErrorCodes.ABA_1000.getErrorCode(),</span>
<span class="nc" id="L102">                                                   ErrorCodes.ABA_1000.getErrorMnemonic() );</span>
        }

        // Quick Check
        // Is the parameter empty/blank
<span class="nc bnc" id="L107" title="All 2 branches missed.">        if( paramAbaRouteNumber.trim().equals( &quot;&quot; ) ) {</span>
<span class="nc" id="L108">            throw new AbaRouteValidationException( ErrorCodes.ABA_1001.getErrorCode(),</span>
<span class="nc" id="L109">                                                   ErrorCodes.ABA_1001.getErrorMnemonic() );</span>
        }

        // Quick Check
        // Make sure the string length is right
        int _strLen;

<span class="nc" id="L116">        _strLen = paramAbaRouteNumber.length();</span>

        // See if it's the right length
<span class="nc bnc" id="L119" title="All 2 branches missed.">        if( _strLen != 9 ) {</span>

            // Is it to short?
<span class="nc bnc" id="L122" title="All 2 branches missed.">            if( _strLen &lt; 9 ) {</span>
<span class="nc" id="L123">                throw new AbaRouteValidationException( ErrorCodes.ABA_1002.getErrorCode(),</span>
<span class="nc" id="L124">                                                       ErrorCodes.ABA_1002.getErrorMnemonic() );</span>
            }
            else {

                // Must be to long.
<span class="nc" id="L129">                throw new AbaRouteValidationException( ErrorCodes.ABA_1003.getErrorCode(),</span>
<span class="nc" id="L130">                                                       ErrorCodes.ABA_1003.getErrorMnemonic() );</span>
            }
        }

        // Quick Check
        // Finally, let's just do a scan and make sure it's a number
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if( !isNumeric( paramAbaRouteNumber ) ) {</span>
<span class="nc" id="L137">            throw new AbaRouteValidationException( ErrorCodes.ABA_1004.getErrorCode(),</span>
<span class="nc" id="L138">                                                   ErrorCodes.ABA_1004.getErrorMnemonic() );</span>
        }

        // -----------------------------------------------------------------------------
        // -----------------------------------------------------------------------------
        // So we got this far, lets start breaking it down.
        boolean returnBool;

<span class="nc" id="L146">        returnBool = breakdownAbaNumber( paramAbaRouteNumber );</span>

        // Must be good!
<span class="nc" id="L149">        return( returnBool );</span>
    }

    /**
     * Method: validateAbaNumberChecksum
     *
     * @param  paramAbaRouteNumber
     *         The target ABA number to test.
     *
     * @return boolean
     *         True if all the characters were digits.
     *         False if there was a problem.
     */
    static private boolean validateAbaNumberChecksum( final String paramAbaRouteNumber ) {

        // Even thought initializing this to zero is redundant, performance tests
        // were slightly improved.
<span class="nc" id="L166">        int checksumTotal = 0;</span>

        // Set up all the ints
        int i1, i2, i3, i4, i5, i6, i7, i8, i9;

        // Break up the string so we can look at the numbers.
        // Although this is a bit simplistic, doing it this way (as opposed to
        // to a loop) produced much faster results.
<span class="nc" id="L174">        i1 = Character.getNumericValue( paramAbaRouteNumber.charAt( 0 ) );</span>
<span class="nc" id="L175">        i2 = Character.getNumericValue( paramAbaRouteNumber.charAt( 1 ) );</span>
<span class="nc" id="L176">        i3 = Character.getNumericValue( paramAbaRouteNumber.charAt( 2 ) );</span>
<span class="nc" id="L177">        i4 = Character.getNumericValue( paramAbaRouteNumber.charAt( 3 ) );</span>
<span class="nc" id="L178">        i5 = Character.getNumericValue( paramAbaRouteNumber.charAt( 4 ) );</span>
<span class="nc" id="L179">        i6 = Character.getNumericValue( paramAbaRouteNumber.charAt( 5 ) );</span>
<span class="nc" id="L180">        i7 = Character.getNumericValue( paramAbaRouteNumber.charAt( 6 ) );</span>
<span class="nc" id="L181">        i8 = Character.getNumericValue( paramAbaRouteNumber.charAt( 7 ) );</span>
<span class="nc" id="L182">        i9 = Character.getNumericValue( paramAbaRouteNumber.charAt( 8 ) );</span>

        // Okay, lets crank it through the formula
<span class="nc" id="L185">        checksumTotal = ( ( i3 + i6 + i9 ) + ( 3 * ( i1 + i4 + i7 ) ) + ( 7 * ( i2 + i5 + i8 ) ) );</span>

        // Check the modulus and we're done!
<span class="nc bnc" id="L188" title="All 2 branches missed.">        if( ( checksumTotal % 10 ) != 0 ) {</span>

            // Checksum has failed
<span class="nc" id="L191">            return( false );</span>
        }
        else {

            // Checksum is good!
<span class="nc" id="L196">            return( true );</span>
        }
    }

    /**
     * This method will test to see if the first two characters, when combined to create a
     * number, are within an acceptable range.
     *
     * @param  paramAbaRouteNumber The target string to test.
     *
     * @throws AbaRouteValidationException
     *         There was a problem in converting the ABA number.
     */
    static private void validateFedNumber( final String paramAbaRouteNumber )
            throws AbaRouteValidationException {

        // String off the first 2 numbers and see if they validate.
        String _tempStr;

<span class="nc" id="L215">        _tempStr = paramAbaRouteNumber.substring( 0, 2 );</span>

        // Now, convert the substring to an int
        int _fedNumb;

<span class="nc" id="L220">        _fedNumb = Integer.parseInt( _tempStr );</span>

        // Okay, let's see if it works!
<span class="nc bnc" id="L223" title="All 14 branches missed.">        if( !( ( ( _fedNumb &gt;= 0 ) &amp;&amp; ( _fedNumb &lt;= 12 ) )</span>
                || ( ( _fedNumb &gt;= 21 ) &amp;&amp; ( _fedNumb &lt;= 32 ) )
                || ( ( _fedNumb &gt;= 61 ) &amp;&amp; ( _fedNumb &lt;= 72 ) )
                || ( ( _fedNumb == 80 ) ) ) ) {
<span class="nc" id="L227">            throw new AbaRouteValidationException( ErrorCodes.ABA_1005.getErrorCode(),</span>
<span class="nc" id="L228">                                                   ErrorCodes.ABA_1005.getErrorMnemonic() );</span>
        }
<span class="nc" id="L230">    }</span>

    /**
     * Method: isNumeric
     *
     * Description:
     *         This method will scan the individual numbers in the ABA number
     *         and makre sure they are numeric digits.
     *
     * @param  paramStr
     *         The string which needs to be made up of all numbers.
     *
     * @return boolean
     *         True if all the characters were digits.
     *         False if there was a problem.
     */
    static private boolean isNumeric( final String paramStr ) {

          // Cycle through the character array
<span class="nc" id="L249">          int size = paramStr.length();</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">          for( int i = 0; i &lt; size; i++ ) {</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">              if( !Character.isDigit( paramStr.charAt(i) ) ) {</span>

                  // This is bad!
<span class="nc" id="L254">                  return( false );</span>
              }
          }

          // All is well!
<span class="nc" id="L259">        return( true );</span>
    }
}

/* ---------------------------------------------------------------------------------------
 *
 *  License: Apache 2.0
 *
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use
 *  this file except in compliance with the License.
 *
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software distributed under
 *  the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS
 *  OF ANY KIND, either express or implied including the implied warranties of
 *  merchantability and fitness for a particular purpose.
 *
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *
 * ---------------------------------------------------------------------------------------
 * Class:  com.cardatechnologies.utils.validators.abaroutevalidator.AbaRouteValidator.java
 * Date:   2015/02/11
 * --------------------------------------------------------------------------------------- */
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>