<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>AbaRouteValidator.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">aba.route.validator</a> &gt; <a href="index.source.html" class="el_package">com.cardatechnologies.utils.validators.abaroutevalidator</a> &gt; <span class="el_source">AbaRouteValidator.java</span></div><h1>AbaRouteValidator.java</h1><pre class="source lang-java linenums">package com.cardatechnologies.utils.validators.abaroutevalidator;

//~--- non-JDK imports --------------------------------------------------------

import com.cardatechnologies.utils.validators.abaroutevalidator.exceptions.AbaRouteValidationException;

public class AbaRouteValidator {
<span class="fc" id="L8">    public AbaRouteValidator() {}</span>


    public boolean validate(final String paramAbaRouteNumber) throws AbaRouteValidationException {

        // http://en.wikipedia.org/wiki/Routing_transit_number
        //
        // See FRB Regulation CC, Appendix A, which available online here:
        // &lt;http://www.bankersonline.com/regs/229/a229a.html&gt;

        // Quick Check
        // Is the parameter null
<span class="fc bfc" id="L20" title="All 2 branches covered.">        if (paramAbaRouteNumber == null) {</span>
<span class="fc" id="L21">            throw new AbaRouteValidationException(&quot;The ABA Route Number was null.&quot;);</span>
        }

        // Quick Check
        // Is the parameter empty
<span class="pc bpc" id="L26" title="1 of 2 branches missed.">        if (paramAbaRouteNumber == null) {</span>
<span class="nc" id="L27">            throw new AbaRouteValidationException(&quot;The ABA Route Number was empty.&quot;);</span>
        }

        // Quick Check
        // Make sure the string length is right
        int _strLen;

<span class="fc" id="L34">        _strLen = paramAbaRouteNumber.length();</span>

        // Is if it's the right length
<span class="fc bfc" id="L37" title="All 2 branches covered.">        if (_strLen != 9) {</span>

            // Is it to short?
<span class="fc bfc" id="L40" title="All 2 branches covered.">            if (_strLen &lt; 9) {</span>
<span class="fc" id="L41">                throw new AbaRouteValidationException(&quot;The ABA Route Number was not long enough.  (Size was &quot; + _strLen</span>
                        + &quot;).&quot;);
            } else {

                // Must be to long.
<span class="fc" id="L46">                throw new AbaRouteValidationException(&quot;The ABA Route Number was tot long.  (Size was &quot; + _strLen</span>
                        + &quot;).&quot;);
            }
        }

        // Quick Check
        // Finally, let's just do a scan and make sure it's a number
<span class="fc bfc" id="L53" title="All 2 branches covered.">        if (!isNumeric(paramAbaRouteNumber)) {</span>
<span class="fc" id="L54">            throw new AbaRouteValidationException(</span>
                &quot;The ABA Route Number appears to have alphanumeric or formatting characters in it.&quot;);
        }

        // -----------------------------------------------------------------------------
        // -----------------------------------------------------------------------------
        // So we got this far, lets start breaking it down.
<span class="fc" id="L61">        breakdownAbaNumber(paramAbaRouteNumber);</span>

        // Must be good!
<span class="fc" id="L64">        return (true);</span>
    }

    public void validateAbaNumberChecksum(final String paramAbaRouteNumber) throws AbaRouteValidationException {

        // Set up all the int's
        int i1;
        int i2;
        int i3;
        int i4;
        int i5;
        int i6;
        int i7;
        int i8;
        int i9;

        // create the temp char
        char _tempChar ;

        // I1
<span class="fc" id="L84">        _tempChar = paramAbaRouteNumber.charAt(0);</span>
<span class="fc" id="L85">        i1        = Character.getNumericValue(_tempChar);</span>

        // I2
<span class="fc" id="L88">        _tempChar = paramAbaRouteNumber.charAt(1);</span>
<span class="fc" id="L89">        i2        = Character.getNumericValue(_tempChar);</span>

        // I3
<span class="fc" id="L92">        _tempChar = paramAbaRouteNumber.charAt(2);</span>
<span class="fc" id="L93">        i3        = Character.getNumericValue(_tempChar);</span>

        // I4
<span class="fc" id="L96">        _tempChar = paramAbaRouteNumber.charAt(3);</span>
<span class="fc" id="L97">        i4        = Character.getNumericValue(_tempChar);</span>

        // I5
<span class="fc" id="L100">        _tempChar = paramAbaRouteNumber.charAt(4);</span>
<span class="fc" id="L101">        i5        = Character.getNumericValue(_tempChar);</span>

        // I6
<span class="fc" id="L104">        _tempChar = paramAbaRouteNumber.charAt(5);</span>
<span class="fc" id="L105">        i6        = Character.getNumericValue(_tempChar);</span>

        // I7
<span class="fc" id="L108">        _tempChar = paramAbaRouteNumber.charAt(6);</span>
<span class="fc" id="L109">        i7        = Character.getNumericValue(_tempChar);</span>

        // I8
<span class="fc" id="L112">        _tempChar = paramAbaRouteNumber.charAt(7);</span>
<span class="fc" id="L113">        i8        = Character.getNumericValue(_tempChar);</span>

        // I9
<span class="fc" id="L116">        _tempChar = paramAbaRouteNumber.charAt(8);</span>
<span class="fc" id="L117">        i9        = Character.getNumericValue(_tempChar);</span>

        // Okay, lets crank it through the formula
        int checksumTotal;

<span class="fc" id="L122">        checksumTotal = ((i1 * 3) + (i2 * 7) + (i3) +</span>

        //
        (i4 * 3) + (i5 * 7) + (i6) +

        //
        (i7 * 3) + (i8 * 7) + (i9));

        // Check the modulus and we're done!
<span class="fc bfc" id="L131" title="All 2 branches covered.">        if ((checksumTotal % 10) != 0) {</span>
<span class="fc" id="L132">            throw new AbaRouteValidationException(&quot;The ABA Route Number has failed its checksum test.&quot;);</span>
        }
<span class="fc" id="L134">    }</span>

    public void breakdownAbaNumber(final String paramAbaRouteNumber) throws AbaRouteValidationException {

        // Check first two digits.
<span class="fc" id="L139">        validateFedNumber(paramAbaRouteNumber);</span>

        // Alright, now see if the number holds up to scrunity!
<span class="fc" id="L142">        validateAbaNumberChecksum(paramAbaRouteNumber);</span>
<span class="fc" id="L143">    }</span>

    public void validateFedNumber(final String paramAbaRouteNumber) throws AbaRouteValidationException {

        // String off the first 2 numbers and see if they validate.
        String _tempStr;

<span class="fc" id="L150">        _tempStr = paramAbaRouteNumber.substring(0, 2);</span>

        // Now, convert the substring to an int
        int _fedNumb;

<span class="fc" id="L155">        _fedNumb = Integer.parseInt(_tempStr);</span>

        // Okay, let's see if it works!
<span class="pc bpc" id="L158" title="5 of 14 branches missed.">        if (!(((_fedNumb &gt;= 0) &amp;&amp; (_fedNumb &lt;= 12)) || ((_fedNumb &gt;= 21) &amp;&amp; (_fedNumb &lt;= 32))</span>
                || ((_fedNumb &gt;= 61) &amp;&amp; (_fedNumb &lt;= 72)) || ((_fedNumb == 80)))) {
<span class="fc" id="L160">            throw new AbaRouteValidationException(</span>
                &quot;The first two characters of the ABA Routing Number do no correspond to a valid Federal ABA prefix.&quot;);
        }
<span class="fc" id="L163">    }</span>

    public boolean isNumeric(final String str) {

        // Cycle through the character array
<span class="fc bfc" id="L168" title="All 2 branches covered.">        for (char _char : str.toCharArray()) {</span>
<span class="fc bfc" id="L169" title="All 2 branches covered.">            if (!Character.isDigit(_char)) {</span>

                // This is bad!
<span class="fc" id="L172">                return (false);</span>
            }
        }

        // All is well!
<span class="fc" id="L177">        return (true);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>